# /04_fix_pr_feedback

## 使い方

```
/04_fix_pr_feedback <PR番号>
```

指定された PR のレビューコメントを確認し、指摘された内容を修正します。

### 使用例

```
/04_fix_pr_feedback 3
/04_fix_pr_feedback 15
```

## 実行内容

`gh pr view $ARGUMENTS` で PR の詳細とレビューコメントを確認し、以下の手順で修正を進めます：

### 1. 準備・分析

- [ ] PR 詳細の確認（`gh pr view $ARGUMENTS --json title,body,reviews,comments`）
- [ ] レビューコメントの内容を理解
- [ ] 指摘された問題点を整理
- [ ] 現在のブランチが PR の feature ブランチであることを確認
- [ ] **元の PR で変更されたファイルリストを確認**（`gh pr view $ARGUMENTS --json files`）

### 2. 影響範囲の特定（デグレ防止）

- [ ] **修正対象の機能が使用されている全ての場所を検索**
  - コンポーネントの使用箇所を Grep で検索
  - 関連するルーティング設定を確認
  - レイアウトコンポーネントの場合は、それを使用する全ビューを確認
- [ ] **依存関係の確認**
  - 修正するコンポーネントが他のコンポーネントに影響を与えないか確認
  - インポート/エクスポートの整合性を確認
- [ ] **関連する既存の動作を理解**
  - 修正前の動作を確認・記録
  - テストケースがあれば確認

### 3. 修正計画

- [ ] 必要な修正タスクを Todo リストで管理
- [ ] 修正の優先度を決定（critical > major > minor > suggestion）
- [ ] **デグレチェックリストの作成**
  - 修正によって影響を受ける可能性のある機能をリストアップ
  - 各機能の動作確認方法を明記

### 4. 修正実装

- [ ] 各指摘事項に対する修正を実装
- [ ] **修正時の注意点**：
  - ルーティング構造を変更する場合は、レイアウトコンポーネントの確認必須
  - レイアウトコンポーネントを修正する場合は、`<slot />` vs `<router-view />` を確認
  - グローバルな変更（例：パスの変更）は、全使用箇所を更新
- [ ] コードの品質向上（リファクタリング、最適化）
- [ ] 新しい要件があれば追加実装

### 5. デグレチェック（重要）

- [ ] **元の PR で実装された機能が正常に動作することを確認**
- [ ] **影響を受ける可能性のある機能を全てテスト**
  - ナビゲーション関連の修正：全ページ遷移を確認
  - レイアウト関連の修正：全ビューコンポーネントの表示を確認
  - API 関連の修正：関連する全エンドポイントをテスト
- [ ] **ブラウザでの手動テスト**
  - 修正箇所の動作確認
  - 関連機能の動作確認
  - 異なるルートからのアクセスを確認

### 6. 品質確認

- [ ] セルフレビュー実施
- [ ] テスト実行（該当する場合）
- [ ] lint/typecheck 実行
- [ ] **デグレが発生していないことの最終確認**

### 7. 更新・フォローアップ

- [ ] 修正内容を適切な粒度でコミット
- [ ] PR ブランチにプッシュ
- [ ] レビューコメントに対する返信（必要に応じて）
- [ ] **修正内容と影響範囲の説明を PR に追加コメント**

## コミットメッセージ形式

```
fix: [レビュー指摘事項の修正]

- [具体的な修正内容1]
- [具体的な修正内容2]
- [影響範囲の説明]

Addresses: PR #$ARGUMENTS レビューコメント
```

## レビューコメントへの返信テンプレート

```markdown
## 修正完了

### 修正内容

- ✅ [指摘事項 1]: [修正内容の説明]
- ✅ [指摘事項 2]: [修正内容の説明]

### デグレチェック結果

- ✅ [機能 1]: 正常動作を確認
- ✅ [機能 2]: 正常動作を確認
- ✅ 影響範囲: [影響を受けた箇所と確認結果]

### 追加で実装した改善点

- [改善点 1]
- [改善点 2]
```

## 注意事項

- レビューアーの指摘を正確に理解してから修正に取り掛かる
- **修正前に必ず影響範囲を特定する**
- 指摘事項が不明確な場合は、質問コメントで確認する
- **修正によって新たな問題（デグレ）が発生しないよう注意深く実装する**
- 大きな変更の場合は、事前にレビューアーと相談する
- 修正後は必ず self-review を実施する
- **特にルーティングやレイアウト関連の修正は慎重に行う**

## デグレを防ぐためのチェックポイント

### ルーティング関連の修正時

- [ ] パスを変更した場合、全てのリンクとリダイレクトを更新したか
- [ ] レイアウトコンポーネントは `<router-view />` を使用しているか
- [ ] ネストされたルートの親子関係は正しいか
- [ ] 認証ガードは正常に動作するか

### コンポーネント関連の修正時

- [ ] インポート/エクスポートの整合性は保たれているか
- [ ] プロパティやイベントの変更が親コンポーネントに影響しないか
- [ ] グローバルに使用されているコンポーネントの場合、全使用箇所を確認したか

### API 関連の修正時

- [ ] エンドポイントの変更が全ての呼び出し箇所に反映されているか
- [ ] レスポンスの型変更が適切に処理されているか
- [ ] エラーハンドリングは適切か

## 対応する指摘の種類

### Critical（緊急）

- セキュリティの脆弱性
- 機能が動作しない重大なバグ
- データ整合性の問題

### Major（重要）

- 設計上の問題
- パフォーマンスの重大な問題
- ユーザビリティの重要な問題

### Minor（軽微）

- コードスタイルの問題
- 命名規則の問題
- 軽微なリファクタリング

### Suggestion（提案）

- より良い実装方法の提案
- 将来的な拡張性の考慮
- ドキュメントの改善提案
